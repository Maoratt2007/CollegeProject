<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="menu.css">
  <link rel="shortcut icon" type="x-icon" href="assets/home-pizza.png"><!--the icon of our web-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order</title>
  <!-- Include jQuery library -->
  <script src="jquery.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"><!--the link that enables us to use icons -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script><!--call to bootstrap-->
</head>
<body>

<h1>Order Form</h1>
  
<form id="orderForm">
    <a href="/menu" class="fas fa-reply custom-reply-icon"></a> <!-- Add the "custom-reply-icon" class -->
  <label for="name">Name:</label>
  <input type="text" id="name" name="name" required><br>
  
  <label for="address">Address:</label>
  <input type="text" id="address" name="address" required><br>
  
  <label for="creditCard">Credit Card:</label>
  <input type="text" id="creditCard" name="creditCard" required><br>
  
  <a type="Submit"  onclick="AddOrder()">Submit</a>
</form>
<div id="orderList">

</div>
<div id="recipet">

</div>

<!-- Filter button and category buttons -->


<script>
  // Replace this URL with your actual API endpoint to fetch product data
  const apiEndpoint = 'http://localhost:3000/api/order';
  const orderes=[];

  // Function to fetch and render product data
  function AddOrder() {
    const name = $('#name').val();
  const address = $('#address').val();
  const credit_card = $('#creditCard').val();

  const storedItems = JSON.parse(localStorage.getItem('items'));
  console.log(storedItems)
  const total_price = JSON.parse(localStorage.getItem('total_price'));
  console.log(total_price)
  const userId = JSON.parse(localStorage.getItem('userId'));



    const orderData = {
    name: name,
    price:total_price,
    address: address,
    credit_card:credit_card,
    items:storedItems,
    userId:userId

  };
  //אם אני רוצה הזמנות של אותו יוזר  אז לעשות API חדש  שיתן לי את כל ההזמנות לפי אורדר

    $.ajax({
    url: apiEndpoint, // Update the URL to your API endpoint
    method: 'POST',
    contentType: 'application/json',
    data: JSON.stringify(orderData),
    success: function (response) {
      localStorage.setItem('orderes', JSON.stringify(orderes));
    },
    error: function (error) {
      console.error('Error creating order:', error);
    },
  });

  const recipetContainer = $('#recipet');
  recipetContainer.empty(); // Clear existing products

  const recipetElement=` <div class="recipetOrder">
    your order is acceception
      <h2>NameOrder: "${orderData.name}"</h2>
      Paid: "${orderData.price}"$
      <a href="/" class="backToHomePage"> Submit</a>
    </div>`;
    recipetContainer.append(recipetElement);

  }


  
</script>
</body>
</html>